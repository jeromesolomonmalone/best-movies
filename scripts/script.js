const films = {
  "Ла-Ла Ленд": {
    title: "Ла-Ла Ленд",
    original: "La La Land",
    director: "Дэмьен Шазелл",
    year: 2016,
    place: 1,
    opinion:
      "«Ла-Ла Ленд» — это головокружительная ода любви и мечте, от которой невозможно отвести взгляд! Эмма Стоун и Райан Гослинг создают на экране такой пронзительный дуэт, что каждая сцена с их участием вызывает трепет в сердце. Фильм покоряет безупречной стилистикой, где яркий Лос-Анджелес становится частью романтической истории, а музыкальные номера не просто украшают картину — они двигают сюжет вперёд. Трогательная история о выборе между любовью и карьерой заставляет переживать за героев всем сердцем. Дэмьен Шазелл создал настоящее чудо, где визуальная красота сочетается с эмоциональной глубиной, а финал картины оставляет неизгладимый след в душе даже у тех, кто не любит мюзиклы. Это кино, в которое невозможно не влюбиться!",
    quote: [
      {
        quote:
          "Я смотрел его три или четыре раза, это просто потрясающая режиссёрская работа. И это при том, что я не люблю мюзиклы.",
        who: "Кристофер Нолан, режиссёр",
      },
    ],
    link: "https://www.kinopoisk.ru/film/841081/",
  },
  Одержимость: {
    title: "Одержимость",
    original: "Whiplash",
    director: "Дэмьен Шазелл",
    year: 2013,
    place: 2,
    opinion:
      "Дебютная работа Дэмьена Шазелла демонстрирует его феноменальный талант, который не раз подтвердился в будущем. Он сумел создать фильм-триллер, где музыка становится инструментом психологического давления, а каждая сцена держит в состоянии непрекращающегося напряжения. Сильная актёрская игра главных героев создаёт атмосферу постоянного эмоционального накала, словно задержав дыхание в начале, зритель выдыхает лишь в финале, а после, переведя дух, испытывает желание добавить барабанные партии в свой плейлист.",
    link: "https://www.kinopoisk.ru/film/725190/",
  },
  "Петля времени": {
    title: "Петля времени",
    original: "Looper",
    director: "Райан Джонсон",
    year: 2012,
    place: 3,
    opinion:
      "«Петля времени» — это уникальное сочетание научной фантастики и человеческого драматизма, где каждый элемент работает на общую картину. Гордон-Левитт превзошёл все ожидания в роли молодого Уиллиса, а Эмили Блант создала незабываемый образ женщины, чья сила сочетается с хрупкостью. Продуманный до мелочей сюжет о путешествиях во времени разворачивается в удивительно реалистичном будущем, которое заставляет задуматься о последствиях наших действий.",
    link: "https://www.kinopoisk.ru/film/463354/",
  },
  Впритык: {
    title: "Впритык",
    original: "Due Date",
    director: "Тодд Филлипс",
    year: 2010,
    place: 4,
    opinion:
      "«Впритык» — эталонная комедия от мастера жанра Тодда Филлипса, где идеальный дуэт Роберта Дауни-младшего и Зака Галифианакиса создаёт уморительную химию на экране. Режиссёр в своём фирменном стиле подаёт зрителю порцию неистового юмора, каждая сцена которого способна вызвать искренний смех и остаться в памяти надолго.",
    link: "https://www.kinopoisk.ru/film/464282/",
  },
  "Мальчишник в Вегасе": {
    title: "Мальчишник в Вегасе",
    original: "The Hangover",
    director: "Тодд Филлипс",
    year: 2009,
    place: 5,
    opinion:
      "«Мальчишник в Вегасе» — безусловная классика комедийного жанра, которая покорила зрителей своим искромётным юмором и яркими персонажами. Зак Галифианакис создал незабываемый образ, ставший культовым, а камео Майка Тайсона стало настоящим подарком для зрителей. Невероятное количество смешных моментов, нескончаемый поток шуток делают этот фильм обязательным к просмотру.",
    link: "https://www.kinopoisk.ru/film/426004/",
  },
  Претенденты: {
    title: "Претенденты",
    original: "Challengers",
    director: "Лука Гуаданьино",
    year: 2024,
    place: 6,
    opinion:
      "«Претенденты» — это кинематографическое произведение, где безупречная визуальная составляющая сливается с мощным электронным саундтреком, который хочется добавить в личный плейлист. Зендея, Майк Фейст и Джош О’Коннор создают настолько гармоничный актёрский ансамбль, что их химия на экране буквально искрит. Особенно впечатляют инновационные съёмки теннисных матчей — от классических планов до завораживающих кадров с точки зрения летящего мяча — словно словесная перепалка на корте, где каждая подача становится острым выпадом.",
    link: "https://www.kinopoisk.ru/film/4860116/",
  },
  "Одиннадцать друзей Оушена": {
    title: "Одиннадцать друзей Оушена",
    original: "Oceans Eleven",
    director: "Стивен Содерберг",
    year: 2001,
    place: 7,
    opinion:
      "Трилогия «Друзья Оушена» началась с безупречного «Одиннадцати друзей Оушена», где сформировалась легендарная команда мошенников. Химия между Клуни и Питтом настолько сильна, что их дуэт выглядит как пара, прожившая вместе не один десяток лет. Мастерское сочетание криминального сюжета с уморительными сценами сделало всю трилогию признанным эталоном жанра, а вечно что-то поедающий Питт стал настоящим украшением фильма.",
    link: "https://www.kinopoisk.ru/film/770/",
  },
  "Середина 90-х": {
    title: "Середина 90-х",
    original: "Mid90s",
    director: "Джона Хилл",
    year: 2018,
    place: 8,
    opinion:
      "Дебют талантливого актера Джона Хилла в режиссуре — это очаровательная история, которая цепляет своей искренностью и теплотой. «Середина 90-х» мастерски погружает зрителя в атмосферу прошлого десятилетия, позволяя на время забыть о реальности и почувствовать себя ребёнком, живущим в Америке 90-х.",
    link: "https://www.kinopoisk.ru/film/1040690/",
  },
  "Под покровом ночи": {
    title: "Под покровом ночи",
    original: "Nocturnal Animals",
    director: "Том Форд",
    year: 2016,
    place: 9,
    opinion:
      "Режиссёр Том Форд создал визуально безупречное произведение, где каждый кадр словно сошёл с подиума высокой моды. Джейк Джилленхол в двойной роли демонстрирует впечатляющую трансформацию эмоций, особенно в сценах, где его глаза говорят больше слов. Но самый главный перфомансс демонстрирует Аарон Тейлор-Джонсон в роли антагониста-психопата — его образ настолько пугающий, что вызывает мурашки по коже, за что он справедливо получил признание критиков в виде «Золотого глобуса». И всё это дополняется двумя переплетающимися сюжетами, создающими уникальную структуру повествования, где реальность и вымысел сливаются в единое целое.",
    link: "https://www.kinopoisk.ru/film/909898/",
  },
  Выживший: {
    title: "Выживший",
    original: "The Revenant",
    director: "Алехандро Гонсалес Иньярриту",
    year: 2015,
    place: 10,
    opinion:
      "Величественная красота дикой природы в «Выжившем» завораживает с первых минут. Снятые при естественном освещении кадры создают неповторимую атмосферу, где холодные пейзажи соседствуют с теплыми оттенками, даря зрителю парадоксальное чувство одиночества и умиротворения одновременно. Леонардо ДиКаприо, как всегда, блестяще справляется с ролью, и «Оскар» за этот фильм — заслуженная награда не только для актёра, но и для всех его фанатов.",
    quote: [
      {
        quote:
          "Я ставлю Алехандро в один ряд с мастерами живописи. Сделан огромный шаг в техническом плане, люди проделали колоссальную работу. Я не видел ничего подобного с точки зрения натурализма — визуального реализма. Поэзия, достигнутая с помощью новейших технологий. Я рад, что мы существуем в культуре, способной оценить такое искусство и признать, что оно нам необходимо.",
        who: "Шон Пенн, актёр, режиссёр",
      },
    ],
    link: "https://www.kinopoisk.ru/film/522941/",
  },
  "Малыш на драйве": {
    title: "Малыш на драйве",
    original: "Baby Driver",
    director: "Эдгар Райт",
    year: 2017,
    place: 11,
    opinion:
      "«Малыш на драйве» поражает своим уникальным подходом к сочетанию музыки и экшена. Каждая сцена, от динамичных погонь до диалоговых эпизодов, пропитана особой энергетикой благодаря безупречному саундтреку и отточенному монтажу, а звездный актёрский состав делает этот криминальный триллер по-настоящему запоминающимся.",
    link: "https://www.kinopoisk.ru/film/902939/",
  },
  "Джанго освобожденный": {
    title: "Джанго освобожденный",
    original: "Django Unchained",
    director: "Квентин Тарантино",
    year: 2012,
    place: 12,
    opinion:
      "«Джанго освобождённый» — многослойное полотно от Квентина Тарантино, где за фасадом классического вестерна скрывается пронзительная история любви. Фирменное тарантиновское мастерство проявляется в каждой детали повествования — потрясающие декорации и костюмы, дополненные инновационным саундтреком, который мастерски соединяет кантри и рэп, создают неповторимую атмосферу, а отточенные диалоги держат в напряжении от начала до конца. А Леонардо ДиКаприо в роли антагониста демонстрирует одну из лучших своих работ. Его персонаж настолько омерзителен и харизматичен одновременно, что зритель не может оторвать от него взгляд.",
    link: "https://www.kinopoisk.ru/film/586397/",
  },
  Артист: {
    title: "Артист",
    original: "The Artist",
    director: "Мишель Хазанавичус",
    year: 2011,
    place: 13,
    opinion:
      "«Артист» — удивительное доказательство того, что кино не нуждается в словах и цвете, чтобы трогать сердца зрителей. Жан Дюжарден очаровывает своим обаянием, а чёрно-белое изображение придаёт фильму особый шарм и элегантность. Фильм демонстрирует, как сильная история и выразительная игра актёров могут превзойти современные спецэффекты, доказывая вечную силу классического кинематографа. Магия немого рассказа оказалась настолько убедительной, что картина получила признание в виде пяти «Оскаров». Особого упоминания заслуживает пёс Угги — четвероногий актёр становится полноправным героем повествования, заслуживающим не меньше оваций, чем его человеческие коллеги, и доказывает, что актёрский талант не знает границ.",
    link: "https://www.kinopoisk.ru/film/539550/",
  },
  "Стражи галактики": {
    title: "Стражи галактики",
    original: "Guardians of the Galaxy",
    director: "Джеймс Ганн",
    year: 2014,
    place: 14,
    opinion:
      "В этом космическом приключении главное — не спецэффекты, а человеческие отношения. Джеймс Ганн создал удивительный ансамбль персонажей, каждый из которых находит в команде свой дом, свою семью. Каждый персонаж здесь ищет спасение и утешение в команде, и именно эта эмоциональная связь делает картину особенной. Великолепно подобранный саундтрек, наполненный забытыми хитами прошлого, усиливает эмоциональное воздействие. Примечательно, что первые пять минут фильма, наряду с мультфильмом «Вверх», стали для меня единственным кинематографическим опытом, способным вызвать слёзы с самого начала повествования.",
    quote: [
      {
        quote:
          "“Стражи” в какой-то степени являются лучшим фильмом Marvel из всех, когда-либо выпущенных. Наверное, довольно странно слышать эти слова от человека с таким большим эго, как у меня.",
        who: "Роберт Дауни мл., актёр",
      },
      {
        quote:
          "Роль Криса Пратта в «Стражах Галактики» изменила Голливуд. Пратт показал, что главные герои боевиков не обязаны быть брутальными, задумчивыми и мрачными. Они могут быть жизнерадостными и более простыми, как Питер Квилл.",
        who: "Глен Пауэлл, актёр",
      },
    ],
    link: "https://www.kinopoisk.ru/film/689066/",
  },
  "007: Координаты «Скайфолл»": {
    title: "007: Координаты «Скайфолл»",
    original: "Skyfall",
    director: "Сэм Мендес",
    year: 2012,
    place: 15,
    opinion:
      "Это не просто очередной фильм о Бонде — это его самое честное и глубокое воплощение, где легендарный агент предстаёт не непобедимым супергероем, а уязвимым человеком со своими страхами и слабостями. Хавьер Бардем в роли антагониста демонстрирует лучшее воплощение злодея во всей франшизе, а личная месть, ставшая движущей силой сюжета, делает историю приземлённой и понятной каждому. Великолепная операторская работа Роджера Дикинса и режиссёрское видение Сэма Мендеса создают безупречный визуальный ряд, а фокус на отношениях Бонда с М делает историю пронзительно личной и запоминающейся.",
    link: "https://www.kinopoisk.ru/film/408871/",
  },
  "Миссия невыполнима: Последствия»": {
    title: "Миссия невыполнима: Последствия»",
    original: "Mission: Impossible – Fallout",
    director: "Кристофер Маккуорри",
    year: 2018,
    place: 16,
    opinion:
      "Фильм поднимает планку экшена на недосягаемую высоту, где Том Круз лично исполняет сложнейшие трюки: от пилотирования вертолёта до прыжков с высоты 7,5 километров. Хитросплетённый сюжет с запутанными интригами, двойными играми и невозможностью предугадать действия персонажей делает картину лучшим представителем жанра шпионского триллера. А Генри Кавилл создаёт запоминающийся образ антагониста, чья харизма заставляет пересмотреть отношение к классическим усам.",
    link: "https://www.kinopoisk.ru/film/926540/",
  },
  "Достать ножи": {
    title: "Достать ножи",
    original: "Knives Out",
    director: "Райан Джонсон",
    year: 2019,
    place: 17,
    opinion:
      "«Достать ножи» — глоток свежего воздуха в перенасыщенном детективными историями кинематографе. Райан Джонсон создал стильное, яркое и харизматичное кино, где каждый персонаж, от главных до второстепенных, проработан с исключительной тщательностью. Дэниэл Крэйг в роли детектива Бенуа Блана создаёт образ, достойный встать в один ряд с легендарными сыщиками вроде Пуаро и Холмса. Мастерски сплетённый сюжет держит в напряжении до последней минуты, а пёстрый актёрский состав делает картину по-настоящему особенной, что закономерно привело к созданию франшизы.",
    link: "https://www.kinopoisk.ru/film/1188529/",
  },
  Интерстеллар: {
    title: "Интерстеллар",
    original: "Interstellar",
    director: "Кристофер Нолан",
    year: 2014,
    place: 18,
    opinion:
      "Это не просто фильм, а настоящее путешествие в неизведанные уголки вселенной. Кристофер Нолан создал свой magnum opus, где научная достоверность сочетается с потрясающей визуальной красотой, а Мэттью Макконахи в главной роли демонстрирует всю глубину своего таланта и выдаёт лучшую роль в своей карьере. Потрясающая визуализация космоса настолько завораживает, что невозможно не сделать скриншот этой невероятной красоты, а научная составляющая настолько убедительна, что граница между фантастикой и реальностью размывается. О фильме можно говорить бесконечно, подобно тому, как бесконечны космические просторы, но каждый, кто видел картину, уже знает, почему она занимает особое место в истории кино.",
    quote: [
      {
        quote:
          "Я обожаю «Интерстеллар», потому что нахожу его очень чувственным. Помню, как смотрел его в кино, когда мои дети были ещё маленькими. Он оказал на меня большое влияние. Разбил мне сердце.",
        who: "Киллиан Мёрфи, актёр",
      },
      {
        quote:
          "«Интерстеллар» — мой любимый фильм, в котором я когда-либо снимался.",
        who: "Тимоти Шаламе, актёр",
      },
    ],
    link: "https://www.kinopoisk.ru/film/258687/",
  },
  "Кунг-фу Панда": {
    title: "Кунг-фу Панда",
    original: "Kung Fu Panda",
    director: "Марк Осборн и Джон Стивенсон",
    year: 2008,
    place: 19,
    opinion:
      "«Кунг-фу Панда» — это уникальное сочетание доброго юмора и захватывающего экшена, где главный герой покоряет своей искренностью и внутренней силой. По учит нас важнейшему уроку: оставаться собой, несмотря на давление окружающих. Тай Лунг — один из самых запоминающихся антагонистов в анимации, а мудрость Угвэя оставляет неизгладимый след в душе зрителя. Ведь «случайности не случайны», надо всегда помнить об этом.",
    link: "https://www.kinopoisk.ru/film/103734/",
  },
  Рататуй: {
    title: "Рататуй",
    original: "Ratatouille",
    director: "Брэд Бёрд и Ян Пинкава",
    year: 2007,
    place: 20,
    opinion:
      "Мультфильм покоряет своей душевностью и глубиной, разворачиваясь на фоне живописного Парижа, где каждый кадр пропитан любовью к кулинарии и искусству. Pixar создала уникальную историю, в которой каждый найдёт что-то своё: будь то страсть к еде или понимание того, что даже самый суровый критик может вновь обрести вкус к жизни благодаря искренности и вере в простые радости.",
    link: "https://www.kinopoisk.ru/film/89514/",
  },
  "Проект X: Дорвались": {
    title: "Проект X: Дорвались",
    original: "Project X",
    director: "Нима Нуризаде",
    year: 2012,
    place: 21,
    opinion:
      "Эта молодёжная комедия — кинематографический эквивалент самой громкой вечеринки, где реальность уступает место безудержному веселью. Основанная на реальных событиях история превращается в абсолютный хаос, который невозможно остановить, а саундтрек мгновенно стал культовым: каждый трек тут же оказался в плейлистах слушателей, превратившись в обязательный саундтрек для любой тусовки. Да, многие удивятся, увидев фильм в списке лучших, но после первого просмотра возникает непреодолимое желание пересматривать его снова и снова. Атмосфера безудержного веселья и возможность стать частью легендарной вечеринки делают «Проект X» безусловным лидером среди молодёжных комедий своего поколения.",
    link: "https://www.kinopoisk.ru/film/507440/",
  },
  "Безумный Макс: Дорога ярости": {
    title: "Безумный Макс: Дорога ярости",
    original: "Mad Max: Fury Road",
    director: "Джордж Миллер",
    year: 2015,
    place: 22,
    opinion:
      "«Безумный Макс: Дорога ярости» — это умопомрачительный аттракцион, где два часа неистового экшена сливаются в единый поток адреналина. Стилистически безупречное кино, где постапокалиптические пустыни и головокружительные погони создают завораживающий визуальный пир. Непрекращающееся музыкальное сопровождение держит зрителя в постоянном напряжении, превращая просмотр в экстремальное путешествие на американских горках.",
    quote: [
      {
        quote:
          "В фильме всё всегда находится в действии. Все прошлые события, связанные с героями, показаны очень естественно. Камера всегда движется и никогда не задерживается долго на чём-то одном. Меня это очень вдохновило.",
        who: "Пон Чжун Хо, режиссёр",
      },
      {
        quote:
          "Я посмотрел «Дорогу ярости» и не понимаю, как Джордж Миллер это сделал. Я не понимаю, как в процессе съёмок не умерли сотни людей. Вокруг было столько реальных выстрелов… Меня поражает та координация действий, с которой каждый подошёл к своему делу. Сценарий великолепен, постановка изумительна, идеи велики. Он исключительный постановщик.",
        who: "Стивен Содерберг, режиссёр",
      },
      {
        quote:
          "Это визуально впечатляюще. Это безумие, но таков Джордж. Он учёный, он Эйнштейн монтажа и способен собрать воедино всё необходимое, чтобы создать по-настоящему захватывающую сцену.",
        who: "Мел Гибсон, актёр, режиссёр",
      },
    ],
    link: "https://www.kinopoisk.ru/film/453406/",
  },
  "Большой куш": {
    title: "Большой куш",
    original: "Snatch",
    director: "Гай Ричи",
    year: 2000,
    place: 23,
    opinion:
      "«Большой куш» — вершина творчества молодого Гая Ричи, ещё не покорившегося студийным канонам. Фильм демонстрирует непревзойдённый талант Ричи создавать неповторимые криминальные истории. Хитросплетённый сюжет не даёт оторваться от экрана, а каждый персонаж, от главных до второстепенных, становится незабываемым. Даже Брэд Питт, очарованный талантом режиссёра, сам изъявил желание поработать с Ричи и блестяще воплотил образ легендарного цыгана-боксера Микки, чья харизма в сочетании с актёрским мастерством сделала персонажа культовым. Лента покоряет своим уникальным стилем, искромётным чёрным юмором и остроумными диалогами, которые мгновенно ушли в народ, а безупречная режиссура делает картину по-настоящему выдающейся.",
    link: "https://www.kinopoisk.ru/film/526/",
  },
  Дюна: {
    title: "Дюна",
    original: "Dune",
    director: "Дени Вильнёв",
    year: 2021,
    place: 24,
    opinion:
      "Фильм Вильнёва — триумфальное воплощение «Дюны» на экране, где безупречный стиль сочетается с эпическим размахом. Будучи преданным фанатом оригинала, режиссёр создал идеальную интерпретацию, преодолев пресловутое «проклятие Дюны». Звёздный актёрский состав, невероятная визуальная красота, масштаб повествования и органичное единство двух частей делают эту работу одной из лучших экранизаций в истории кино.",
    quote: [
      {
        quote:
          "Дени Вильнёв снял один из самых блестящих научно-фантастических фильмов, которые я когда-либо видел.",
        who: "Стивен Спилберг, режиссёр",
      },
      {
        quote:
          "Я очень люблю этот фильм. По прошествии двух с половиной часов я не хотел, чтобы это закончилось. Я хотел ещё больше. Меня поражает в «Дюне» то, что она поистине эпична.",
        who: "Джеймс Кэмерон, режиссёр",
      },
    ],
    link: "https://www.kinopoisk.ru/film/409424/",
  },
  Отступники: {
    title: "Отступники",
    original: "The Departed",
    director: "Мартин Скорсезе",
    year: 2006,
    place: 25,
    opinion:
      "Фильм демонстрирует непревзойдённое мастерство Скорсезе в жанре криминальной драмы. Захватывающий сюжет о двойной игре — полицейский в мафии и мафиози в полиции — разворачивается в виртуозном исполнении звёздного состава. Джек Николсон с его фирменной улыбкой, мрачный и грубый, непохожий на себя, ДиКаприо, хитрый как лис Дэймон, а также мастерское изображение бостонского итало-американского мира создают незабываемую динамику. Но апогея фильм достигает в финальной сцене — она навсегда остаётся в памяти зрителя и по праву считается одной из самых эффектных, неожиданных и лучших в истории кино.",
    quote: [
      {
        quote:
          "Этот фильм настолько насыщен идеями, что ваше сознание не может отвлечься ни на что, кроме происходящего на экране. О, и у него неоднозначная концовка, которая, возможно, является одной из лучших за всё время.",
        who: "Джош Сэфди, режиссёр",
      },
    ],
    link: "https://www.kinopoisk.ru/film/81314/",
  },
  "Волк с Уолл-стрит": {
    title: "Волк с Уолл-стрит",
    original: "The Wolf of Wall Street",
    director: "Мартин Скорсезе",
    year: 2013,
    place: 26,
    opinion:
      "«Волк с Уолл-стрит» — это грандиозная биографическая сага Мартина Скорсезе, основанная на невероятной, почти фантастической истории реального успеха и падения. Фильм буквально захлестнут волной безумия: секс, наркотики и алкоголь, которыми насыщена картина, не превращают фильм в пошлое зрелище, а, наоборот, подчёркивают безумие и абсурдность происходящего. Скорсезе, как всегда, сумел подобрать отличный актёрский состав, где Ди Каприо демонстрирует одну из самых ярких и харизматичных своих ролей, Марго Робби покоряет своей красотой и шармом, превратившись после премьеры в один из главных секс-символов Голливуда, а Джона Хилл демонстрирует впечатляющий рост как артист. Всё это режиссёр превращает в уникальное произведение, где безумие становится искусством.",
    quote: [
      {
        quote:
          "Это очень длинный фильм, но он не кажется затянутым. В нём есть что-то особенное в темпе повествования и энергетике. Я думаю: «Как, чёрт возьми, Скорсезе удалось это сделать в его возрасте?» Он просто проникся этим маниакальным безумием.",
        who: "Бенни Сэфди, режиссёр, актёр",
      },
    ],
    link: "https://www.kinopoisk.ru/film/462682/",
  },
  "Омерзительная восьмерка": {
    title: "Омерзительная восьмерка",
    original: "The Hateful Eight",
    director: "Квентин Тарантино",
    year: 2015,
    place: 27,
    opinion:
      "«Омерзительная восьмёрка» — грандиозное достижение Квентина Тарантино, где режиссёр демонстрирует своё непревзойдённое мастерство в искусстве диалога. Почти трёхчасовая картина, построенная преимущественно на разговорах, держит зрителя в напряжении от начала до конца. Театральная манера повествования, усиленная закадровым голосом самого Тарантино, и впечатляющие декорации превращают фильм в незабываемое зрелище. А блестящий актёрский ансамбль, включая неожиданное появление Ченнинга Татума, делает фильм одним из самых сильных вестернов в истории кинематографа, доказывая, что перестрелки не являются обязательным атрибутом жанра.",
    link: "https://www.kinopoisk.ru/film/819101/",
  },
  "Семь психопатов": {
    title: "Семь психопатов",
    original: "Seven Psychopaths",
    director: "Мартин Макдона",
    year: 2012,
    place: 28,
    opinion:
      "Фильм представляет собой головокружительную смесь жанров, где Мартин Макдона демонстрирует своё мастерство в создании неординарных историй. Режиссёр виртуозно балансирует между смешным и пугающим, создавая неповторимую атмосферу, где кровавые сцены соседствуют с уморительными диалогами. Колин Фаррелл в роли главного героя демонстрирует потрясающую харизму, а Сэм Рокуэлл создаёт незабываемый образ психопата, балансирующего на грани безумия. Но в этом фильме каждый персонаж, будь то главный герой или второстепенный, играет важную роль в общей мозаике повествования. Так, смешение жанров, глубокие характеры и нестандартные сюжетные решения делают фильм по-настоящему запоминающейся.",
    link: "https://www.kinopoisk.ru/film/586584/",
  },
  "Всё везде и сразу": {
    title: "Всё везде и сразу",
    original: "Everything Everywhere All at Once",
    director: "Дэн Кван и Дэниэл Шайнерт",
    year: 2021,
    place: 29,
    opinion:
      "Это беспрецедентное кинематографическое явление — фильм, который намеренно нарушает все правила и создаёт собственные. Режиссёры Дэн Кван и Дэниэл Шайнерт смело экспериментируют с формой, создавая кинематографический коктейль из самых разных влияний от MTV до YouTube, что делает картину абсолютно уникальной. Но за внешней эксцентрикой и порой шокирующими сценами скрывается пронзительная история о важных жизненных вопросах. И этот фильм невозможно забыть — он либо покоряет зрителя, либо оставляет в недоумении. Такой подход позволил картине не только привлечь внимание публики, но и завоевать признание профессионального сообщества, отмеченное семью статуэтками «Оскар».",
    link: "https://www.kinopoisk.ru/film/1322324/",
  },
  "Сити-Айленд": {
    title: "Сити-Айленд",
    original: "City Island",
    director: "Рэймонд Де Фелитта",
    year: 2009,
    place: 30,
    opinion:
      "«Сити-Айленд» — удивительно недооценённый фильм, который очаровывает своей душевностью и искренностью. Действие разворачивается не в самом Нью-Йорке, а в его уютном пригороде, где живёт обычная семья, и это создаёт особую атмосферу домашнего уюта и тепла. Энди Гарсия в главной роли — настоящее украшение картины, а финальная сцена, в которой все накопленные противоречия и эмоции главного героя находят своё яркое, комичное разрешение, по силе эмоционального воздействия не уступает знаменитому финалу «Однажды в… Голливуде». Это именно тот фильм, который хочется пересматривать снова и снова.",
    link: "https://www.kinopoisk.ru/film/418802/",
  },
};

const emptyMessages = {
  have_watched: {
    first: "Я пока не смотрел ни один из этих фильмов…",
    second:
      "Если вы посмотрели фильм из списка, обязательно установите флажок под его записью, и здесь появится итоговое количество просмотров. (Я сохраню ваш прогресс)",
  },
  want_to_watch: {
    first: "…но я уверен, что что-то из этого мне подойдёт.",
    second:
      "Следите за фильмами, которые вы хотите посмотреть, установив флажки под их записями.",
  },
};
const basicLink = "https://jeromesolomonmalone.github.io/best-movies/";
const VideoUtils = {
  cleanName(str) {
    return str
      .replace(/\s+/g, "-")
      .replace(/[:;!?–*./\\/]/g, "")
      .replace(/-{2,}/g, "-");
  },

  getPoster(original) {
    return `${basicLink}video/poster/${this.cleanName(original)}.jpg`;
  },

  getCover(original) {
    return `${basicLink}images/sizes/300/${this.cleanName(original)}.jpg`;
  },
};

function renderHeader() {
  const container = document.querySelector(".header_videos");
  const countEl = document.querySelector(".header_title_count");
  const caseEl = document.querySelector(".header_title_case");

  const filmsList = Object.values(films);
  const filmCount = filmsList.length;
  countEl.textContent = filmCount;
  caseEl.textContent = (function (n) {
    const last2 = n % 100;
    if (last2 >= 11 && last2 <= 19) return "лучших фильмов";
    const last1 = n % 10;
    return last1 === 1
      ? "лучший фильм"
      : last1 >= 2 && last1 <= 4
      ? "лучших фильма"
      : "лучших фильмов";
  })(filmCount);

  container.innerHTML = "";

  const indices = new Set();
  const totalVideos = 12;
  while (indices.size < totalVideos) {
    indices.add(Math.floor(Math.random() * filmsList.length));
  }
  let loadedCount = 0;

  [...indices].forEach((idx, i) => {
    const film = filmsList[idx];
    const cleaned = VideoUtils.cleanName(film.original);

    const block = document.createElement("div");
    block.className = `header_video_block header_video_block_${i + 1}`;

    const video = document.createElement("video");
    video.className = "header_video";
    video.preload = "auto";
    video.loop = video.muted = video.autoplay = video.playsInline = true;
    video.poster = VideoUtils.getPoster(film.original);
    video.src = `${basicLink}video/mobile/${cleaned}.mp4`;
    video.addEventListener("loadedmetadata", () => {
      loadedCount++;
      if (loadedCount === totalVideos) {
        container.querySelectorAll(".header_video").forEach((v) => {
          v.style.opacity = "1";
        });
      }
    });

    block.appendChild(document.createElement("div")).className =
      "header_video_wrapper";
    block.firstChild.appendChild(video);
    container.appendChild(block);
  });
}
function initHeaderScroll() {
  const header = document.querySelector(".header");
  const blocks = document.querySelectorAll(".header_video_block");

  const h = parseFloat(getComputedStyle(header).height);
  const s = header.offsetTop;
  const e = s + h;
  const eFast = e - h / 3;

  const pos = [
    ["-200%", "-200%", "-200%", "0%"], // 1
    ["-100%", "-200%", "-200%", "-200%"], // 2
    ["0%", "-200%", "-200%", "-100%"], // 3
    ["100%", "-200%", "0%", "0%"], // 4
    ["-200%", "-100%", "100%", "-200%"], // 5
    ["100%", "-100%", "-100%", "-200%"], // 6
    ["-200%", "0%", "-100%", "0%"], // 7
    ["100%", "0%", "100%", "-100%"], // 8
    ["-200%", "100%", "0%", "-100%"], // 9
    ["-100%", "100%", "100%", "0%"], // 10
    ["0%", "100%", "0%", "-200%"], // 11
    ["100%", "100%", "-100%", "-100%"], // 12
  ];

  let t = 0;

  function update() {
    blocks.forEach((b, i) => {
      const [sx, sy, ex, ey] = pos[i];
      b.style.transform = `translate3D(calc(${sx} + ${t} * (${ex} - ${sx})), calc(${sy} + ${t} * (${ey} - ${sy})), -100px)`;
    });
  }

  function scroll() {
    const y = window.scrollY;
    if (y <= s) t = 0;
    else if (y >= eFast) t = 1;
    else t = (y - s) / (eFast - s);
    update();
  }

  update();
  window.addEventListener("scroll", scroll, { passive: true });
}

function addScrollHandler() {
  const navHeight = document.querySelector(".navigation").offsetHeight;
  function handleScroll(selector) {
    document.querySelectorAll(selector).forEach((container) => {
      container.addEventListener("click", (e) => {
        const link = e.target.closest('a[href^="#"]');
        if (!link) return;

        e.preventDefault();
        const target = document.querySelector(link.getAttribute("href"));
        if (target) {
          const targetPosition =
            target.getBoundingClientRect().top + window.scrollY - navHeight;
          window.scrollTo({ top: targetPosition });
        }
      });
    });
  }
  handleScroll(".navigation");
  handleScroll(".watchlist_movie_list");
}

document.addEventListener("DOMContentLoaded", () => {
  const storedTheme = localStorage.getItem("theme");
  if (storedTheme === "dark") {
    document.body.classList.add("dark-theme");
  }

  const seenSet = new Set(
    JSON.parse(localStorage.getItem("movieWatchlist"))?.seen || []
  );
  const wantSet = new Set(
    JSON.parse(localStorage.getItem("movieWatchlist"))?.want || []
  );
  const sortedFilms = Object.values(films)
    .sort((a, b) => a.place - b.place)
    .reverse();
  let isDesktop = window.innerWidth > 500;

  function createWatchlistContainers() {
    const template = document.querySelector(".watchlist_container");

    [
      ["have_watched_container", "have_watched_container"],
      ["want_to_watch_container", "want_to_watch_container"],
    ].forEach(([id, cls]) => {
      const clone = template.cloneNode(true);
      clone.id = id;
      clone.classList.add(cls);
      document.querySelector(".watchlist_containers").append(clone);
    });

    template.remove();
  }
  const watchlistTitles = {
    seen: document.querySelector(".navigation_watchlist p:first-child")
      .textContent,
    want: document.querySelector(".navigation_watchlist p:nth-child(2)")
      .textContent,
  };

  renderHeader();
  initHeaderScroll();
  updateNavigationPlaces();
  renderMovies();
  createWatchlistContainers();
  updateWatchlist();
  updateWatchlistCounts();
  addScrollHandler();

  window.addEventListener("resize", () => {
    if (window.innerWidth > 500 === isDesktop) return;
    isDesktop = window.innerWidth > 500;
    document.querySelectorAll(".movie_video").forEach((video) => {
      const place = +video.closest(".movie_item").id.replace("movie-", "");
      const film = sortedFilms.find((f) => f.place === place);
      const cleaned = VideoUtils.cleanName(film.original);
      video.src = `${basicLink}video/${
        isDesktop ? "desktop/" : "mobile/"
      }${cleaned}.mp4`;
    });
  });

  function updateNavigationPlaces() {
    const container = document.querySelector(".navigation_places");
    let html = "";

    for (let i = Math.floor(sortedFilms.length / 5) * 5; i >= 5; i -= 5) {
      html += `<a href="#movie-${i}">${i}</a>`;
    }

    container.innerHTML = html;
  }

  function updateWatchlistCounts() {
    const haveNum = document.querySelector(
      ".navigation_watchlist p:first-child .num"
    );
    const wantNum = document.querySelector(
      ".navigation_watchlist p:nth-child(2) .num"
    );

    if (!haveNum || !wantNum) return;

    const tasks = [
      { elem: haveNum, value: seenSet.size },
      { elem: wantNum, value: wantSet.size },
    ];

    tasks.forEach(({ elem, value }) => {
      if (elem.textContent !== String(value)) {
        elem.classList.add("fade-out");
        setTimeout(() => {
          elem.textContent = value;
          elem.classList.remove("fade-out");
        }, 200);
      }
    });
  }

  function renderMovies() {
    const container = document.querySelector(".all_movies");
    container.innerHTML = "";

    function createMovieItem(film) {
      const template = document.getElementById("movie-template").content;
      const clone = document.importNode(template, true);
      const item = clone.querySelector(".movie_item");
      item.id = `movie-${film.place}`;

      const video = clone.querySelector(".movie_video");
      const cleaned = VideoUtils.cleanName(film.original);
      video.src = `${basicLink}video/${
        isDesktop ? "desktop/" : "mobile/"
      }${cleaned}.mp4`;
      video.poster = VideoUtils.getPoster(film.original);
      video.addEventListener("loadedmetadata", () => {
        video.style.opacity = "1";
      });

      clone.querySelector(".movie_place").textContent = film.place;
      clone.querySelector(".movie_name").textContent = film.title;
      clone.querySelector(
        ".movie_director_and_year"
      ).textContent = `${film.director}, ${film.year}`;
      clone.querySelector(".movie_opinion").textContent = film.opinion;
      clone.querySelector(
        ".movie_link"
      ).textContent = `“${film.title}” на Кинопоиске`;
      clone.querySelector(".movie_link").href = film.link;

      const quotesContainer = clone.querySelector(".movie_quotes");
      if (film.quote && film.quote.length > 0) {
        quotesContainer.innerHTML = film.quote
          .map(
            (q) => `
            <div class="movie_quote">
                <p>“${q.quote}”</p>
                <p>${q.who}</p>
            </div>
        `
          )
          .join("");
      } else {
        quotesContainer.remove();
      }

      const poster = clone.querySelector(".saving_poster");
      poster.src = VideoUtils.getCover(film.original);
      poster.alt = film.title;
      poster.addEventListener("load", () => {
        poster.style.opacity = "1";
      });

      const seenCheckbox = clone.querySelector('input[name="already-seen"]');
      const wantCheckbox = clone.querySelector('input[name="want-to-watch"]');

      seenCheckbox.checked = seenSet.has(film.place);
      wantCheckbox.checked = wantSet.has(film.place);

      seenCheckbox.onchange = () =>
        toggleMovie(film.place, "seen", seenCheckbox.checked);
      wantCheckbox.onchange = () =>
        toggleMovie(film.place, "want", wantCheckbox.checked);

      return clone;
    }

    sortedFilms.forEach((film) => {
      const item = createMovieItem(film);
      container.appendChild(item);
    });
  }

  function toggleMovie(place, type, checked) {
    const item = document.getElementById(`movie-${place}`);
    const seenCheck = item.querySelector('input[name="already-seen"]');
    const wantCheck = item.querySelector('input[name="want-to-watch"]');

    if (type === "seen" && checked) {
      wantSet.delete(place);
      wantCheck.checked = false;
    }
    if (type === "want" && checked) {
      seenSet.delete(place);
      seenCheck.checked = false;
    }

    checked
      ? type === "seen"
        ? seenSet.add(place)
        : wantSet.add(place)
      : type === "seen"
      ? seenSet.delete(place)
      : wantSet.delete(place);

    updateWatchlist();
    updateWatchlistCounts();
    localStorage.setItem(
      "movieWatchlist",
      JSON.stringify({ seen: [...seenSet], want: [...wantSet] })
    );
  }

  function updateWatchlist() {
    updateContainer("have_watched_container", seenSet, watchlistTitles.seen);
    updateContainer("want_to_watch_container", wantSet, watchlistTitles.want);
  }

  function getBaseWidth(size) {
    const widthMap = {
      91: 29,
      74: 32,
      58: 36,
      37: 40,
      31: 50,
      26: 56,
      21: 60,
      17: 64,
      13: 80,
      10: 84,
      7: 100,
      5: 110,
      3: 150,
    };

    const sortedKeys = Object.keys(widthMap)
      .map(Number)
      .sort((a, b) => b - a);

    for (const key of sortedKeys) {
      if (size >= key) return widthMap[key];
    }

    return 160;
  }
  function calculateDimensions(size, screenWidth) {
    const baseWidth = getBaseWidth(size);
    const reduction = screenWidth < 415 ? (415 - screenWidth) * 0.00241 : 0;

    return {
      imgWidth: baseWidth * (1 - reduction),
      scale: 1 - reduction,
    };
  }

  function createScreenshot(element, width, height) {
    const clone = element.cloneNode(true);
    clone.style.backgroundColor = getComputedStyle(element).backgroundColor;
    clone.style.transform = "none";
    clone.style.boxSizing = "border-box";
    clone.style.margin = "0";
    clone.style.position = "absolute";
    clone.style.top = "0";
    clone.style.left = "0";
    clone.style.width = `${width}px`;
    clone.style.maxWidth = `${width}px`;
    clone.style.height = `${height}px`;
    clone.style.padding = `290px 125px`;

    const subtitle = clone.querySelector(".watchlist_subtitle");
    subtitle.style.fontSize = `79px`;

    const title = clone.querySelector(".watchlist_title");
    title.style.fontSize = `232px`;
    title.style.marginBottom = `160px`;

    const logo = clone.querySelector(".watchlist_logo");
    logo.style.height = `230px`;
    logo.style.width = `auto`;
    logo.style.bottom = "145px";
    logo.style.right = "145px";

    const posters = clone.querySelector(".watchlist_posters");
    const originalPosters = element.querySelector(".watchlist_posters");
    const size = posters.querySelectorAll("img").length;
    posters.style.height = `78.65%`;
    posters.style.gap = `30px`;
    posters.innerHTML = "";
    originalPosters.querySelectorAll("img").forEach((originalImg, index) => {
      const newImg = document.createElement("img");
      newImg.src = originalImg.src.replace(
        "posters/",
        `sizes/${getBaseWidth(size) * 6}/`
      );
      newImg.style.width = `${getBaseWidth(size) * 6}px`;
      newImg.style.borderRadius = `20px`;
      newImg.style.opacity = `1`;
      newImg.style.objectFit = "contain";
      posters.appendChild(newImg);
    });

    document.body.appendChild(clone);
    return clone;
  }

  function updateContainer(id, set, title) {
    const container = document.getElementById(id);
    const wrapper = container.querySelector(".watchlist_wrapper");
    const button = container.querySelector(".copy-button");
    const list = container.querySelector(".watchlist_movie_list");
    const screenWidth = window.innerWidth;
    const { imgWidth, scale } = calculateDimensions(set.size, screenWidth);
    const headerTitle = document.querySelector(".header_title").innerText;
    const wrapperLogo = `${basicLink}images/letter.png`;
    if (!set.size) {
      const message =
        emptyMessages[
          id === "have_watched_container" ? "have_watched" : "want_to_watch"
        ];
      wrapper.innerHTML = `
      <div class="watchlist_empty_messages">
      <p class="watchlist_title">${message.first}</p>
            <p class="watchlist_ps">${message.second}</p>
            <img class="watchlist_logo" src="${wrapperLogo}"/>
            </div>
        `;
      list.innerHTML = "";
      button.disabled = true;
      return;
    }

    const totalFilms = sortedFilms.length;
    const newTitle =
      set.size === totalFilms
        ? id === "have_watched_container"
          ? watchlistTitles.seen + " все"
          : watchlistTitles.want + " все"
        : title;

    wrapper.innerHTML = `
        <h4 class="watchlist_subtitle">${headerTitle}</h4>
        <p class="watchlist_title">${newTitle}&nbsp;${set.size}.</p>
        <div class="watchlist_posters"></div>
        <img class="watchlist_logo" src="${wrapperLogo}"/>
    `;
    const posters = container.querySelector(".watchlist_posters");

    if (posters) {
      posters.style.setProperty("--img-width", `${imgWidth}px`);
      wrapper.style.transform = `scale(${scale})`;

      posters.innerHTML = [...set]
        .map((place) => {
          const film = sortedFilms.find((f) => f.place === place);
          return `<img src="${VideoUtils.getCover(film.original)}" alt="${
            film.title
          }" crossorigin="anonymous">`;
        })
        .join("");

      posters.querySelectorAll("img").forEach((img) => {
        img.addEventListener("load", () => {
          img.style.opacity = "1";
        });
      });
    }

    list.innerHTML = [...set]
      .map((place) => {
        const film = sortedFilms.find((f) => f.place === place);
        return `<a href="#movie-${place}">${film.title}</a>`;
      })
      .join(" ● ");

    button.disabled = false;
    const originalText = button.textContent;
    const screenshotSize = { width: 2491, height: 4428 };

    button.onclick = async () => {
      try {
        if (button.disabled) return;

        button.textContent = "Загрузка...";
        button.disabled = true;

        const clone = createScreenshot(
          wrapper,
          screenshotSize.width,
          screenshotSize.height
        );

        await new Promise((resolve) => {
          clone.querySelectorAll("img").forEach((img) => {
            img.onload = () => {
              resolve();
            };
          });
        });

        try {
          const canvas = await html2canvas(clone, {
            width: screenshotSize.width,
            height: screenshotSize.height,
            logging: false,
            useCORS: true,
          });

          const imageData = canvas.toDataURL("image/jpeg", 1.0);
          const blob = await fetch(imageData).then((r) => r.blob());

          if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = "watchlist.jpg";
            a.click();
            URL.revokeObjectURL(a.href);
          } else {
            const link = document.createElement("a");
            link.href = imageData;
            link.download = "watchlist.jpg";
            link.click();
          }

          document.body.removeChild(clone);
        } finally {
          button.textContent = originalText;
          button.disabled = false;
        }
      } catch (error) {
        console.error("Ошибка при создании скриншота:", error);
        alert("Произошла ошибка при создании скриншота");
      }
    };
  }

  window.addEventListener("resize", () => {
    const screenWidth = window.innerWidth;

    ["have_watched_container", "want_to_watch_container"].forEach((id) => {
      const container = document.getElementById(id);
      if (!container) return;

      const wrapper = container.querySelector(".watchlist_wrapper");
      const posters = container.querySelector(".watchlist_posters");
      const set = id === "have_watched_container" ? seenSet : wantSet;
      const size = set.size;

      const { imgWidth, scale } = calculateDimensions(size, screenWidth);

      if (posters) {
        posters.style.setProperty("--img-width", `${imgWidth}px`);
      }

      wrapper.style.transform = `scale(${scale})`;
    });
  });

  document.querySelector(".navigation") &&
    (() => {
      const nav = document.querySelector(".navigation");

      const checkPos = () =>
        nav.classList.toggle("open", nav.getBoundingClientRect().top <= 0);

      checkPos();
      window.addEventListener("scroll", checkPos);
      window.addEventListener("resize", checkPos);
    })();
});
